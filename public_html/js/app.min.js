"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},body=document.body,timer;!function(t){t.app={sandwich:{config:{keyHooks:!1,selector:".js-sandwich-menu",wrapper:".wrapper",overlay:".menu-overlay"},extend:function(t){var e=this;if("undefined"!=typeof t){var o;for(o in t)"undefined"!=typeof e.config[o]&&(e.config[o]=t[o])}},isOpen:function(){return t("body").hasClass("page-visible")},hide:function(){t("body").removeClass("page-open"),setTimeout(function(){t("body").removeClass("page-visible")},10),t(this.config.overlay).css({visibility:"hidden"})},toggle:function(){t("body").hasClass("page-visible")?(t("body").removeClass("page-open"),setTimeout(function(){t("body").removeClass("page-visible")},200)):(t("body").addClass("page-open"),setTimeout(function(){t("body").addClass("page-visible")},10));var e="visible";t("body").hasClass("page-open")||(e="hidden"),t(_this.config.overlay).css({visibility:e})},sandwichTrigger:function(){var e=this;e.config.keyHooks&&t("body").on("keydown",function(t){27==t.keyCode&&e.isOpen()&&e.toggle()}),t("body").on("click",e.config.selector,function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e.toggle()})},overlayTrigger:function(){var e=this;t("body").on("click",e.config.overlay,function(t){e.hide()})},init:function(t){this.extend(t),this.sandwichTrigger(),this.overlayTrigger()}},run:function(){if(t.app.sandwich.init(),t.app.module.bear.init(),t.app.module.form_ajax(),t.app.module.resize(function(){},500),t(".integer").on("keypress",function(t){if([0,8].indexOf(t.which)<0&&(t.which<48||t.which>57))return!1}),t("body").on("click",".insert-cart-trigger",function(e){e.preventDefault();var o=t(this);if(!o.hasClass("in-cart")){var n=t(this).data("id_product");if(t.post("/cart/insert/",{action:"insert",id:n,quantity:1},function(e){t("#total_count").text(e),o.html("В корзине").addClass("in-cart")}),!t("#added_in_basket").length){var i=['<div class="popover" id="added_in_basket">','<div class="form-order__complete">','<div class="form-order__complete__middle">',"Товар",'<span class="form-order__complete__icon"></span>добавлен в корзину',"</div>","</div>","</div>"].join("");t("body").append(i),setTimeout(function(){t("#added_in_basket").fadeOut(800,function(){t(this).remove()})},500)}}return!1}),t("body").on("click",".toggle-trigger",function(e){e.preventDefault();var o=t(this).attr("href");t(o).length>0&&(t(this).hasClass("ul_list-item_link-drop")&&t(this).toggleClass("ul_list-item_link-drop-up"),t(o).slideToggle(150),t("html, body").animate({scrollTop:t(this).offset().top},"slow"))}),t("body").on("click",".nav-list-item-link",function(e){var o=t(this).closest(".nav-list-item");if(o.find(".submenu").length&&!o.hasClass("opened"))return e.preventDefault(),o.addClass("opened"),!1}),t("body").on("mouseenter",".nav-list-item",function(e){if(t(this).find(".submenu").length){var o=t(this),n=o.find(".submenu");setTimeout(function(){n.addClass("is-show"),setTimeout(function(){n.addClass("is-animate")},10)},50)}}),t("body").on("mouseleave",".nav-list-item",function(e){if(t(this).find(".submenu").length){var o=t(this),n=o.find(".submenu");setTimeout(function(){n.removeClass("is-animate"),setTimeout(function(){n.removeClass("is-show")},250)},50)}}),"undefined"!=typeof t.initPopups&&(t.initPopups(),window.location.hash.length>1&&t(window.location.hash).hasClass("popup")))try{t.popup.open(window.location.hash.substr(1))}catch(e){}},module:{bear:{timeout:2e4,element:"#bear",move:function(e){var o=this,n=o.timeout;if(e=window.innerWidth-e-298,e>window.innerWidth&&(e=window.innerWidth),"undefined"!=typeof t.cookie("_go_")&&(e=t.cookie("_go_")),t.cookie("_go_",e,{expires:7,path:"/"}),"undefined"!=typeof t.cookie("coordinate")&&""!==t.cookie("coordinate")){var i=Math.floor(t.cookie("coordinate"));t(o.element).css({left:i});var a=100-Math.floor(100*(window.innerWidth-i)/window.innerWidth),n=n-n*a/100}t(o.element).stop().animate({left:e},{duration:n,step:function(n,i){t.cookie("coordinate",n,{expires:7,path:"/"}),n==e&&(t(o.element).toggleClass("footer-bear-reverse"),t.removeCookie("coordinate",{path:"/"}),t.removeCookie("_go_",{path:"/"}),t.app.module.bear.move(e))}})},rotate:function(e){t(this.element).find(".footer-bear-inner").stop().animate({rotation:e},{duration:1800,step:function(o,n){t(this).css({transform:"rotate("+o+"deg)"}),o==e&&t.app.module.bear.rotate(e*-1)}})},init:function(){t(window).width()>960&&(this.rotate(6),this.move(0))}},resize:function(e,o){t(window).resize(function(n){window.resizeEvt,t(window).resize(function(){clearTimeout(window.resizeEvt),window.resizeEvt=setTimeout(function(){e.apply()},o)})})},googleMap:function(){var t={zoom:16,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:google.maps.ControlPosition.LEFT_TOP},panControl:!0,panControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!0,styles:[{stylers:[{hue:"#adced5"}]},{elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"water",stylers:[{color:"#c9dfe4"}]}],disableDoubleClickZoom:!0,center:new google.maps.LatLng(43.569787,39.756362)},e=new google.maps.Map(document.getElementById("map-conteiner"),t),o={url:"images/map-bullet.png",size:new google.maps.Size(39,52),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(39,52)};new google.maps.Marker({position:new google.maps.LatLng(43.569787,39.756362),map:e,icon:o})},cache:function(t,e){try{var o,n,i,a=function(t,o){r.push(o),r.length>=s&&e.call(),l.c++},r=[],s=t.length,l={i:{},ac:0,c:0},e=e||function(){};for(i in t)o=t[i],n=new Image,n.src=o,n.onload=a(i,o),l.i[o]=n,l.ac++}catch(c){}},retina:function(){if("devicePixelRatio"in window&&2==window.devicePixelRatio){var e,o=0,n=t("img.replace-2x").get(),i=n.length;for(o;o<i;o++)e=n[o].src,e=e.replace(/\.(png|jpg|gif)+$/i,"@2x.$1"),n[o].src=e}},isUndefined:function(t){return void 0===t},updateImage:function(e){if(t(e).length>0){var o=t(e).attr("src").split("?")[0];t(e).attr("src",o+"?v="+Math.random())}return!1},random:function(t,e){return t=t||0,e=e||100,Math.floor(Math.random()*(e-t+1))+t}}},t.app.movies={},t.app.movies.load=function(){return alert("load more"),!1},t.app.module.form_validation_default=function(e,o){if(e.find(".form_error_block").hide(),e.find(".error").removeClass("error"),e.find(".checkbox__label-error").removeClass("checkbox__label-error"),o){var n=t("#form-errors");n.html("");for(fieldName in o)$field=e.find('input[name="'+fieldName+'"]'),n.append(["<span>",$field.data("error"),"</span>"].join(""))}},t.app.callback_stack={},t.app.callback_stack.form_ajax_default=function(e,o){o.status?o.hasOwnProperty("redirect_url")&&(window.location.href=o.redirect_url):o.errors&&t.app.module.form_validation_default(e,o.errors),o.hasOwnProperty("message")&&t.popup.message(o.title,o.message)},t.app.module.form_ajax=function(){t("body").on("submit",".form-ajax",function(e){var o=t(this);e.preventDefault(),t.ajax({url:o.attr("action"),type:o.attr("method")||"post",data:o.serialize(),dataType:"json",success:function(e){o.data("callback")&&t.app.callback_stack.hasOwnProperty(o.data("callback"))?t.app.callback_stack[o.data("callback")](o,e):t.app.callback_stack.form_ajax_default(o,e),e.status===!0&&""!==e.message&&t.popup.message(e.title,e.message)},error:function(e){t.app.callback_stack.form_ajax_default(o,e),alert("error")}})})},t.app.module.upload_button=function(){t("body").on("submit",".form-file-upload",function(t){return AIM.submit(this,{onStart:function(){},onComplete:function(t){"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t.status===!0&&"undefined"!=typeof t.photo_url}})}),t(document).on("change",".upload_button_onchange",function(){t(this).closest(".upload_button").find(".upload_button_field").length>0&&t(this).closest(".upload_button").find(".upload_button_field").html(t(this).val())})},t.app.custom_placeholder=function(){Modernizr.touch||(t("input, textarea").each(function(){var e,o,n=t(this),i=n.attr("placeholder");i&&(e=n.parent(),o=t('<div class="default-input__placeholder" style="line-height: '+(n.is("textarea")?"36px":(0==e.innerHeight()?"36":e.innerHeight())+"px")+'">'+i+"</div>"),o[n.val().length?"hide":"show"](),n.addClass("custom-placeholder").attr("placeholder",""),e.append(o))}),t("body").on("blur",".custom-placeholder",function(){var e=t(this);e.val().length||e.parent().find(".default-input__placeholder").show()}),t("body").on("focus",".custom-placeholder",function(){t(this).parent().find(".default-input__placeholder").hide()}),t("body").on("click",".default-input__placeholder",function(){var e=t(this);e.hide(),e.parent().find(".custom-placeholder").trigger("focus")}),t("body").on("selectstart",".default-input__placeholder",!1))},t.app.run()}(jQuery),function(t){t.cart={initRequestClick:function(){t("body").on("click",".j-remover-request",function(e){e.preventDefault();var o=t(this).closest(".remover"),n=t(this).data("element"),i=t(this).data("status");return 0!==i&&(t("#cart-product-"+n).length&&t("#cart-product-"+n).fadeOut(function(){t(this).remove()}),console.log(n+" as "+i)),setTimeout(function(){o.fadeOut(function(){t(this).remove()})},150),!1})},init:function(){t.cart.initBuy(),t.cart.initRemove(),t.cart.initControll(),t.cart.initRequestClick(),t("body").on("click",".j-cart-remove",function(e){if(e.preventDefault(),t(this).closest(".list-item-footer").find(".remover").length){var o=t(this).closest(".list-item-footer").find(".remover");o.fadeOut(function(){t(this).remove()})}else{var o,n=t(this).data("element");o=['<div class="remover">','<div class="remover__content">','<div class="remover__title">',"Действительно удалить?","</div>",'<div class="remover__buttons">','<a href="#" data-element="'+n+'" data-status="1" class="remover__button is-yes j-remover-request">Да</a>','<a href="#" data-element="'+n+'" data-status="0" class="remover__button is-no j-remover-request">Нет</a>',"</div>","</div>","</div>"].join(" "),t(this).closest(".list-item-footer").append(o)}return!1})},initBuy:function(){t(".add-cart-trigger").on("click",function(e){e.preventDefault(),t.cart.buyItem(t(this).attr("href").split("-")[1])})},initControll:function(){t(".increase-cart-trigger").on("click",function(e){e.preventDefault(),t.cart.increase(t(this).attr("href").split("-")[1])}),t(".decrease-cart-trigger").on("click",function(e){e.preventDefault(),t.cart.decrease(t(this).attr("href").split("-")[1])})},initRemove:function(){t(".remove-cart-trigger").on("click",function(e){e.preventDefault(),t.cart.removeItem(t(this).attr("href").split("-")[1],this)})},removeItem:function(e,o){t.post("/ajax/cart/remove/",{item:e},function(n){t("#list-item-"+e).find(".incart").length>0&&t("#list-item-"+e).find(".incart").remove(),t(o).hasClass("list-item-incart")?t(o).remove():(t("#incart-item-"+e).html('<a href="#item-'+e+'" title="Добавить в корзину" class="button-cart add-cart-trigger">Купить кресло</a>'),t.cart.initBuy()),t.cart.addedItem("Товар удален из корзины.")})},buyItem:function(e){var o=1;t("#count-"+e).length>0&&(o=parseInt(t("#count-"+e).val())),t.post("../cart.json",{item:e,count:o},function(o){t("#cart-count").length>0&&t("#cart-count").html(o.count),t("#cart-price").length>0&&t("#cart-price").html(o.money),t("#count-"+e).length>0&&t("#count-"+e).val(1),0==t("#list-item-"+e).find(".incart").length&&(t("#incart-item-"+e).html('<a href="#item-'+e+'" title="Удалить из корзины" class="button-remove remove-cart-trigger">Кресло в корзине</a>'),t.cart.initRemove()),t.cart.addedItem()},"JSON")},addedItem:function(e,o){e=e?e:"Товар добавлен в корзину.",o=!!o&&o;var n=o?5e3:1500,i=o?" adding-large":"";0==t("body").find("#item-added-to-cart").length?(t("body").append('<div id="item-added-to-cart" class="showadding'+i+'"><div class="adding-inner"><div class="adding-content">'+e+"</div></div></div>"),setTimeout(function(){t("body").find("#item-added-to-cart").remove()},n)):setTimeout(function(){t("body").find("#item-added-to-cart").remove()},n)},increase:function(e){if(t("#count-"+e).length>0){var o=parseInt(t("#count-"+e).val());o=o?o:0,o++,t("#count-"+e).val(o)}t("#cart-table").length>0&&t.cart.reTotal(e)},decrease:function(e){if(t("#count-"+e).length>0){var o=parseInt(t("#count-"+e).val());o=o?o:1,o>=2?o--:o=1,t("#count-"+e).val(o)}t("#cart-table").length>0&&t.cart.reTotal(e)},reTotal:function(e){if(t("#count-"+e).length>0){var o=parseInt(t("#count-"+e).val());t.post("/ajax/cart/recount/",{item:e,count:o},function(n){var i=parseInt(t("#cart-item-price-"+e).html()),a=o*i;t("#cart-item-total-"+e).html(a),t("#cart-total-count").html(n.count),t("#cart-total-price").html(n.money),t("#cart-count").length>0&&t("#cart-count").html(n.count),t("#cart-price").length>0&&t("#cart-price").html(n.money)},"JSON")}}},t.cart.init()}(jQuery),window.addEventListener("scroll",function(){clearTimeout(timer),body.classList.contains("disable-hover")||body.classList.add("disable-hover"),timer=setTimeout(function(){body.classList.remove("disable-hover")},500)},!1),String.prototype.replaceAll=function(t,e,o){var n=this.toString(),i="",a=n,r=0,s=-1;for(o&&(t=t.toLowerCase(),a=n.toLowerCase());(s=a.indexOf(t))>-1;)i+=n.substring(r,r+s)+e,a=a.substring(s+t.length,a.length),r+=s+t.length;return a.length>0&&(i+=n.substring(n.length-a.length,n.length)),i},Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var o=this.length>>>0;for(e=+e||0,Math.abs(e)===1/0&&(e=0),e<0&&(e+=o,e<0&&(e=0));e<o;e++)if(this[e]===t)return e;return-1});